<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="A safe, fast, lightweight embeddable scripting language written in Rust."><meta name="keywords" content="rust, rustlang, rust-lang, budlang"><title>budlang - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceSerif4-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../FiraSans-Regular.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../FiraSans-Medium.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceCodePro-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceSerif4-Bold.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceCodePro-Semibold.ttf.woff2"><link rel="stylesheet" type="text/css" href="../normalize.css"><link rel="stylesheet" type="text/css" href="../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../ayu.css" disabled><link rel="stylesheet" type="text/css" href="../dark.css" disabled><link rel="stylesheet" type="text/css" href="../light.css" id="themeStyle"><script id="default-settings" ></script><script src="../storage.js"></script><script defer src="../crates.js"></script><script defer src="../main.js"></script><noscript><link rel="stylesheet" href="../noscript.css"></noscript><link rel="alternate icon" type="image/png" href="../favicon-16x16.png"><link rel="alternate icon" type="image/png" href="../favicon-32x32.png"><link rel="icon" type="image/svg+xml" href="../favicon.svg"></head><body class="rustdoc mod crate"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="sidebar-logo" href="../budlang/index.html"><div class="logo-container"><img class="rust-logo" src="../rust-logo.svg" alt="logo"></div></a><h2 class="location"></h2></nav><nav class="sidebar"><a class="sidebar-logo" href="../budlang/index.html"><div class="logo-container"><img class="rust-logo" src="../rust-logo.svg" alt="logo"></div></a><h2 class="location"><a href="#">Crate budlang</a></h2><div class="sidebar-elems"><div class="block"><ul><li class="version">Version 0.0.0</li><li><a id="all-types" href="all.html">All Items</a></li></ul></div><section><div class="block"><ul><li><a href="#modules">Modules</a></li><li><a href="#enums">Enums</a></li></ul></div></section></div></nav><main><div class="width-limiter"><div class="sub-container"><a class="sub-logo-container" href="../budlang/index.html"><img class="rust-logo" src="../rust-logo.svg" alt="logo"></a><nav class="sub"><form class="search-form"><div class="search-container"><span></span><input class="search-input" name="search" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><button type="button">?</button></div><div id="settings-menu" tabindex="-1"><a href="../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../wheel.svg"></a></div></div></form></nav></div><section id="main-content" class="content"><div class="main-heading"><h1 class="fqn"><span class="in-band">Crate <a class="mod" href="#">budlang</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../clipboard.svg" width="19" height="18" alt="Copy item path"></button></span></h1><span class="out-of-band"><a class="srclink" href="../src/budlang/lib.rs.html#1-74">source</a> · <a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span></div><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>A safe, fast, lightweight embeddable scripting language written in Rust.</p>
<p><strong>WARNING: This crate is not anywhere near being ready to publish.</strong></p>
<p><a href="https://crates.io/crates/budlang"><img src="https://img.shields.io/crates/v/budlang.svg" alt="crate version" /></a>
<a href="https://github.com/khonsulabs/budlang/actions?query=workflow:Tests"><img src="https://img.shields.io/github/workflow/status/khonsulabs/budlang/Tests/main" alt="Live Build Status" /></a>
<a href="https://khonsulabs.github.io/budlang/coverage/"><img src="https://khonsulabs.github.io/budlang/coverage/badge.svg" alt="HTML Coverage Report for main branch" /></a>
<a href="https://khonsulabs.github.io/budlang/main/budlang"><img src="https://img.shields.io/badge/docs-main-informational" alt="Documentation" /></a></p>
<h3 id="why-bud"><a href="#why-bud">Why Bud?</a></h3><h4 id="memory-safe"><a href="#memory-safe">Memory-safe</a></h4>
<p>This crate forbids unsafe code (<code>#![forbid(unsafe_code)]</code>) and has no
dependencies.</p>
<h4 id="safe-to-run-untrusted-code"><a href="#safe-to-run-untrusted-code">Safe to run untrusted code</a></h4>
<p>The virtual machine invokes <a href="vm/trait.Environment.html#tymethod.step"><code>Environment::step()</code></a> before each
instruction is exected. The environment can return
<a href="vm/enum.ExecutionBehavior.html#variant.Pause"><code>ExecutionBehavior::Pause</code></a> to pause execution, and the state of the
virtual machine will be saved such that it can be resumed again.</p>
<p><strong>Work In Progress:</strong> Bud will have various configuration
options including maximum stack size, maximum memory used, and more.</p>
<p><strong>Work In Progress:</strong> Bud should never panic. This crate is in early
development, so many instances of <code>todo!()</code> and <code>unwrap()</code> abound. These will
all be replaced with descriptive errors instead of panics.</p>
<p><strong>Work In Progress:</strong> Bud will only support these primitive types: integers,
real numbers (floating point), strings, lists, and maps. Bud will be able to be
extended to support additional features via Rust, placing the developer
embedding Bud in full control of what scripts can do.</p>
<h4 id="efficient"><a href="#efficient">Efficient</a></h4>
<p>Bud is a compiled language powered by its own virtual machine. Currently, Bud
has no optimizer, but the virtual machine code generated by the compiler closely
mirrors the syntax of the language. For example, the repository includes three
examples of a naive <a href="https://en.wikipedia.org/wiki/Fibonacci_number">Fibonacci number</a> function implementation. The <a href="https://github.com/khonsulabs/budlang/blob/main/examples/fib.rs">Bud
version</a> looks like this:</p>
<div class="example-wrap"><pre class="language-bud"><code>function fibonacci(n)
    if n &lt;= 2
        1
    else
        this(n - 1) + this(n - 2)
    end
end</code></pre></div>
<p>Another example <a href="https://github.com/khonsulabs/budlang/blob/main/examples/fib-vm.rs">shows an identical implementation</a> using hand-written
virtual machine instructions. Despite not having an optimizer, the compiled
<code>fibonacci()</code> function’s code is the same number of instructions (with one small
difference):</p>
<div><table><thead><tr><th>#</th><th>compiled</th><th>hand-written</th></tr></thead><tbody>
<tr><td>0</td><td><code>push 2</code></td><td><code>push 2</code></td></tr>
<tr><td>1</td><td><code>push-arg 0</code></td><td><code>push-arg 0</code></td></tr>
<tr><td>2</td><td><code>compare &lt;=</code></td><td><code>compare &lt;=</code></td></tr>
<tr><td>3</td><td><code>if-false-jump-to 6</code></td><td><code>if-false-jump-to 6</code></td></tr>
<tr><td>4</td><td><code>push 1</code></td><td><code>push 1</code></td></tr>
<tr><td>*5</td><td><code>if-false-jump-to 15</code></td><td><code>return</code></td></tr>
<tr><td>6</td><td><code>push 1</code></td><td><code>push 1</code></td></tr>
<tr><td>7</td><td><code>push-arg 0</code></td><td><code>push-arg 0</code></td></tr>
<tr><td>8</td><td><code>sub</code></td><td><code>sub</code></td></tr>
<tr><td>9</td><td><code>recurse-call 1</code></td><td><code>recurse-call 1</code></td></tr>
<tr><td>10</td><td><code>push 2</code></td><td><code>push 2</code></td></tr>
<tr><td>11</td><td><code>push-arg 0</code></td><td><code>push-arg 0</code></td></tr>
<tr><td>12</td><td><code>sub</code></td><td><code>sub</code></td></tr>
<tr><td>13</td><td><code>recurse-call 1</code></td><td><code>recurse-call 1</code></td></tr>
<tr><td>14</td><td><code>add</code></td><td><code>add</code></td></tr>
</tbody></table>
</div><h3 id="why-not-bud"><a href="#why-not-bud">Why not Bud?</a></h3>
<p>It probably doesn’t do what you need (yet):</p>
<ul>
<li><input disabled="" type="checkbox" checked=""/>
Don’t panic in vm</li>
<li><input disabled="" type="checkbox"/>
Don’t panic in compiler</li>
<li><input disabled="" type="checkbox"/>
Don’t panic ih parser</li>
<li><input disabled="" type="checkbox"/>
Support parenthesized expressions as terms</li>
<li><input disabled="" type="checkbox"/>
Add variables (VM supports them already)</li>
<li><input disabled="" type="checkbox"/>
Add loops</li>
<li><input disabled="" type="checkbox" checked=""/>
Add Real (Float) type</li>
<li><input disabled="" type="checkbox"/>
Add String type</li>
<li><input disabled="" type="checkbox"/>
Add List type</li>
<li><input disabled="" type="checkbox"/>
Add Map type</li>
<li><input disabled="" type="checkbox"/>
Ability to write Rust functions</li>
<li><input disabled="" type="checkbox"/>
Implement a REPL</li>
<li><input disabled="" type="checkbox"/>
Consider static variables for persistent module state.</li>
</ul>
<p>Bud is compiled to a virtual machine written using only memory-safe abstractions
in Rust. This yields quite good performance for a dynamically typed language,
but will not be the fastest language.</p>
<h3 id="goals-for-bud"><a href="#goals-for-bud">Goals for Bud</a></h3>
<p>Aside from the goals outlined above, the use cases it’s being designed for are:</p>
<ul>
<li>A <a href="https://bonsaidb.io/">BonsaiDb</a> REPL</li>
<li>Multi-player server-side scripting where user-submitted scripts are allowed.</li>
</ul>
</div></details><h2 id="modules" class="small-section-header"><a href="#modules">Modules</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="mod" href="ast/index.html" title="budlang::ast mod">ast</a></div><div class="item-right docblock-short"><p>The abstract syntax tree Bud uses.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="mod" href="parser/index.html" title="budlang::parser mod">parser</a></div><div class="item-right docblock-short"><p>The interface for parsing Bud code.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="mod" href="symbol/index.html" title="budlang::symbol mod">symbol</a></div><div class="item-right docblock-short"><p>An “interned” string-like type used for identifiers in Bud.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="mod" href="vm/index.html" title="budlang::vm mod">vm</a></div><div class="item-right docblock-short"><p>The Bud virtual machine.</p>
</div></div></div><h2 id="enums" class="small-section-header"><a href="#enums">Enums</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.Error.html" title="budlang::Error enum">Error</a></div><div class="item-right docblock-short"><p>All errors that can be encountered executing Bud code.</p>
</div></div></div></section></div></main><div id="rustdoc-vars" data-root-path="../" data-current-crate="budlang" data-themes="ayu,dark,light" data-resource-suffix="" data-rustdoc-version="1.64.0 (a55dd71d5 2022-09-19)" ></div></body></html>